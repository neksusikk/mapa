<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Mapa MiejscowoÅ›ci</title>

<style>
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #f0d5ff, #e0c3fc);
  }

  #input-container {
    background: #e0c3fc;
    border: 2px solid #b185f5;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    padding: 20px;
    width: 90%;
    max-width: 420px;
    margin: 15px auto;
    text-align: center;
  }

  #input-container input,
  #input-container button {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 8px;
    font-size: 16px;
  }

  #input-container input {
    border: 1px solid #b185f5;
  }

  #input-container button {
    background: #b185f5;
    color: white;
    border: none;
    cursor: pointer;
  }

  #input-container button:hover {
    background: #9a5dd4;
  }

  #bestRouteContainer {
    max-width: 420px;
    margin: 10px auto;
    font-weight: bold;
    background: rgba(255,255,255,0.6);
    padding: 10px;
    border-radius: 10px;
  }

  #map {
    width: 100%;
    height: calc(100vh - 260px);
  }
</style>
</head>

<body>

<div id="input-container">
  IloÅ›Ä‡ liter:
  <input type="number" id="randomCount" min="1">
  <button id="randomLetters">Losuj</button>

  Wylosowane litery:
  <input type="text" id="letterInput">
  <button id="showRoute">PokaÅ¼ trasy</button>
</div>

<div id="bestRouteContainer"></div>
<div id="map"></div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBn7fow-jhcIvU8wCHJaCzQcRdqR9-hRWU"></script>

<script>
// ================= MAPA =================
const startPoint = { lat: 50.81562701491546, lng: 16.27033305958717 };

const map = new google.maps.Map(document.getElementById("map"), {
  center: startPoint,
  zoom: window.innerWidth < 600 ? 12 : 11,
  gestureHandling: "greedy"
});

// START (jedyny niebieski)
new google.maps.Marker({
  position: startPoint,
  map,
  label: { text: "START", color: "white", fontWeight: "bold" },
  icon: {
    path: google.maps.SymbolPath.CIRCLE,
    scale: 16,
    fillColor: "blue",
    fillOpacity: 1,
    strokeColor: "white",
    strokeWeight: 2
  }
});

// ================= DANE =================
const locations = [
{"name":"BorÃ³wno","lat":50.77797954711741,"lng":16.110518811847072},
{"name":"BoguszÃ³w Gorce","lat":50.7559487,"lng":16.2042958},
{"name":"BronÃ³wek","lat":50.9064906,"lng":16.2219214},
{"name":"BurkatÃ³w","lat":50.7923276,"lng":16.4670642},
{"name":"BolkÃ³w","lat":50.92449999999999,"lng":16.10378},
{"name":"Bolkowice","lat":50.9935743,"lng":16.1953672},
{"name":"ChwaliszÃ³w","lat":50.8580439,"lng":16.2235428},
{"name":"Czarny BÃ³r","lat":50.7716843,"lng":16.130063},
{"name":"CieszÃ³w","lat":50.8668723,"lng":16.2607841},
{"name":"Dziecmorowice","lat":50.768593,"lng":16.3499805},
{"name":"DÄ™brznik","lat":50.8120015,"lng":16.0413309},
{"name":"DomanÃ³w","lat":50.8664436,"lng":16.061815},
{"name":"GostkÃ³w","lat":50.8412214,"lng":16.1076669},
{"name":"GrzÄ™dy","lat":50.7446382,"lng":16.1383339},
{"name":"GrzmiÄ…ca","lat":50.6964044,"lng":16.3400719},
{"name":"Granica","lat":50.9301231,"lng":16.3078569},
{"name":"Gluszyca","lat":50.68728,"lng":16.37107},
{"name":"Golinsk","lat":50.6475182,"lng":16.1997391},
{"name":"Glinno","lat":50.7187262,"lng":16.4751437},
{"name":"Jablow","lat":50.7852988,"lng":16.1640059},
{"name":"Jedlina-ZdrÃ³j","lat":50.7252382,"lng":16.3461015},
{"name":"JaczkÃ³w","lat":50.8075730,"lng":16.1029969},
{"name":"Jugowice","lat":50.7214919,"lng":16.4023896},
{"name":"JakubÃ³w","lat":50.8184445,"lng":16.5025550},
{"name":"Kamienna GÃ³ra","lat":50.7852076,"lng":16.0237177},
{"name":"KrzeszÃ³w","lat":50.7333738,"lng":16.070745},
{"name":"KrzeszÃ³wek","lat":50.7161683,"lng":16.0916809},
{"name":"KomorÃ³w","lat":50.8453148,"lng":16.4167546},
{"name":"Kolce","lat":50.665081,"lng":16.4021235},
{"name":"Kowalowa","lat":50.6826517,"lng":16.2033926},
{"name":"Lubomin","lat":50.805072,"lng":16.2050047},
{"name":"LubachÃ³w","lat":50.7680484,"lng":16.433307},
{"name":"Lutomia GÃ³rna","lat":50.7519253,"lng":16.5254117},
{"name":"Lutomia Dolna","lat":50.7573784,"lng":16.5371223},
{"name":"Lipienica","lat":50.7201108,"lng":16.0486238},
{"name":"MokrzeszÃ³w","lat":50.8523182,"lng":16.371938},
{"name":"Milikowice","lat":50.8675912,"lng":16.410211},
{"name":"ModliszÃ³w","lat":50.7930273,"lng":16.393433},
{"name":"Makowice","lat":50.8062243,"lng":16.5083852},
{"name":"MarciszÃ³w","lat":50.8414037,"lng":16.0368994},
{"name":"Michalkowa","lat":50.737853,"lng":16.4510094},
{"name":"MirosÅ‚awice","lat":50.9602860,"lng":16.8228509},
{"name":"Nowy JulianÃ³w","lat":50.7802625,"lng":16.3387494},
{"name":"Nowe Bogaczewice","lat":50.8394319,"lng":16.1338885},
{"name":"Niedzwiedzica","lat":50.7394201,"lng":16.3905156},
{"name":"Nowe SiodÅ‚o","lat":50.6615770,"lng":16.2266005},
{"name":"Olszyniec","lat":50.7298878,"lng":16.3701447},
{"name":"Olszany","lat":50.9120402,"lng":16.3290698},
{"name":"Opoczka","lat":50.7977530,"lng":16.5015326},
{"name":"PogorzaÅ‚a","lat":50.805471,"lng":16.3658487},
{"name":"Podlesie","lat":50.7388666,"lng":16.3580620},
{"name":"PietrzykÃ³w","lat":50.8944720,"lng":16.2185438},
{"name":"PtaszkÃ³w","lat":50.7927741,"lng":16.0406965},
{"name":"PodgÃ³rna","lat":50.8455580,"lng":16.2074870},
{"name":"PrzedwojÃ³w","lat":50.7548233,"lng":16.0156476},
{"name":"Rybnica LeÅ›na","lat":50.7006694,"lng":16.2786536},
{"name":"Rzeczka","lat":50.6693105,"lng":16.4553660},
{"name":"RaszÃ³w","lat":50.8048864,"lng":15.9805648},
{"name":"RÃ³Å¼ana","lat":51.0602367,"lng":16.4310811},
{"name":"RogoÅºnica","lat":51.0000046,"lng":16.2933659},
{"name":"RosciszÃ³w","lat":50.7084561,"lng":16.5481989},
{"name":"Struga","lat":50.8232204,"lng":16.2267887},
{"name":"Stare Bogaczewice","lat":50.8477706,"lng":16.2012401},
{"name":"Siodlkowice","lat":50.8946193,"lng":16.2616388},
{"name":"Sokolowsko","lat":50.6863986,"lng":16.2351322},
{"name":"Sierpnica","lat":50.6614527,"lng":16.4264784},
{"name":"Tomkowa","lat":50.8771569,"lng":16.4594463},
{"name":"Tarnawa","lat":50.9646803,"lng":16.5483440},
{"name":"Tomkowice","lat":50.9412972,"lng":16.2937621},
{"name":"Tuszyn","lat":50.7962901,"lng":16.6488898},
{"name":"Unislaw Slaski","lat":50.7128007,"lng":16.2383277},
{"name":"WitoszÃ³w GÃ³rny","lat":50.8163029,"lng":16.3863663},
{"name":"WitoszÃ³w Dolny","lat":50.8241697,"lng":16.4285465},
{"name":"WitkÃ³w","lat":50.7978667,"lng":16.1299111},
{"name":"Walim","lat":50.6974362,"lng":16.4422202},
{"name":"ZagÃ³rze ÅšlÄ…skie","lat":50.758871,"lng":16.4013558},
{"name":"ZawiszÃ³w","lat":50.8703999,"lng":16.4875682}
];

// ================= LOGIKA =================
let markers = [];

function distance(a,b){
  return Math.hypot(a.lat-b.lat, a.lng-b.lng);
}

function direction(loc){
  const dx = loc.lng - startPoint.lng;
  const dy = loc.lat - startPoint.lat;
  if (Math.abs(dx) > Math.abs(dy)) return dx > 0 ? "prawo" : "lewo";
  return dy > 0 ? "gora" : "dol";
}

function generateRoutes(letters){
  const pools = letters.map(l =>
    locations.filter(x => x.name[0].toUpperCase() === l)
  );

  let combos = [];
  function build(idx, cur){
    if(idx === pools.length){ combos.push([...cur]); return; }
    pools[idx].forEach(x => { cur.push(x); build(idx+1,cur); cur.pop(); });
  }
  build(0,[]);

  combos = combos.map(c => {
    let best = Infinity, order = c;
    for(let i=0;i<c.length;i++){
      const perm = [...c];
      if(i>0)[perm[0],perm[i]]=[perm[i],perm[0]];
      let d=0;
      for(let j=0;j<perm.length-1;j++) d+=distance(perm[j],perm[j+1]);
      if(d<best){best=d;order=perm;}
    }
    return {order, score: best};
  });

  combos.sort((a,b)=>a.score-b.score);
  return combos;
}

document.getElementById("showRoute").onclick = () => {
  markers.forEach(m=>m.setMap(null));
  markers=[];

  const letters = document.getElementById("letterInput").value
    .toUpperCase().split(",").map(x=>x.trim()).filter(Boolean);

  if(!letters.length) return;

  const routes = generateRoutes(letters);
  const best = routes[0];

  let html = "ðŸŸ¢ Najlepsza trasa:<br>"+best.order.map(x=>x.name).join(" â†’ ");

  const usedDirs = new Set();
  usedDirs.add(direction(best.order[0]));

  html += "<br><br>Inne moÅ¼liwe trasy:<br>";

  for(const r of routes){
    const dir = direction(r.order[0]);
    if(usedDirs.has(dir)) continue;
    usedDirs.add(dir);
    html += `(${dir}) ${r.order.map(x=>x.name).join(" â†’ ")}<br>`;
    if(usedDirs.size===4) break;
  }

  document.getElementById("bestRouteContainer").innerHTML = html;

  locations.forEach(loc=>{
    const letter = loc.name[0].toUpperCase();
    if(!letters.includes(letter)) return;
    const isBest = best.order.some(x=>x.name===loc.name);
    const marker = new google.maps.Marker({
      position: loc,
      map,
      label: letter,
      icon:{
        path: google.maps.SymbolPath.CIRCLE,
        scale: 14,
        fillColor: isBest ? "green" : "red",
        fillOpacity: 1,
        strokeColor:"white",
        strokeWeight:2
      }
    });
    markers.push(marker);
  });
};

document.getElementById("randomLetters").onclick = ()=>{
  const count = parseInt(randomCount.value)||1;
  const letters=[...new Set(locations.map(x=>x.name[0].toUpperCase()))];
  randomCount.value="";
  letterInput.value = letters.sort(()=>0.5-Math.random()).slice(0,count).join(",");
};
</script>
</body>
</html>
